function tdialog_start(e,t){$.fn.modal.Constructor.prototype.enforceFocus=function(){};$(e).modal({backdrop:true,keyboard:true});if(typeof t!="undefined"){$(e).on("hidden.bs.modal",function(){t();tdialog_close(e.substring(1))})}else{$(e).on("hidden.bs.modal",function(){tdialog_close(e.substring(1))})}}function tdialog_close(e){$(".modal-backdrop").last().remove();$("#"+e).modal("hide");$("body").removeClass("modal-open");setTimeout(function(){$("#"+e).remove()},300)}function tjquerydialog_start(e,t,n,a,i,r,o,l,s,d,c){$(e).dialog({modal:t,stack:false,zIndex:2e3,draggable:n,resizable:a,height:r,width:i,beforeClose:function(){if(typeof c=="function"){c();return false}return true},close:function(e,t){$(this).remove()},buttons:d});$(e).closest(".ui-dialog").css({zIndex:s});$(".ui-widget-overlay").css({zIndex:100});if(o>0){$(e).closest(".ui-dialog").css({top:o+"px"})}if(l>0){$(e).closest(".ui-dialog").css({left:l+"px"})}}function tform_send_data(e,t,n,a){try{if(t.substr(0,1)=="#"){var i=$(t);var r=[]}else{var i=$("form[name="+e+"] [name='"+t+"']");var r=$("form[name="+e+"] [name='"+t+"[]']")}if(i.length||r.length){if(typeof Adianti.formEventsCounter=="undefined"||Number.isNaN(Adianti.formEventsCounter)){Adianti.formEventsCounter=0}if(Adianti.formEventsCounter==0){if(i.length){if(i.attr("widget")=="thtmleditor"){i.summernote("code",n)}else if(i.attr("role")=="tcombosearch"){if(i.val()!==n){i.select2().val(n).trigger("change.select2")}}else if(i.attr("widget")=="tdbuniquesearch"){tdbuniquesearch_set_value(e,t,n)}else if(i.attr("component")=="multisearch"){if(n){i.select2().val(n).trigger("change.select2")}}else if(i.attr("type")=="radio"){if(n){var o=i.filter("[value="+n+"]").prop("checked",true);if(o.parent().prop("tagName")=="LABEL"){o.parent().parent().find("label").removeClass("active");o.parent().toggleClass("active")}}}else{i.val(n)}if(a){if(i.attr("exitaction")){tform_events_hang_exec(i.attr("exitaction"))}if(i.attr("changeaction")){tform_events_hang_exec(i.attr("changeaction"))}}}else if(r.length){if(r.attr("type")=="checkbox"){r.prop("checked",false);if(n){r.parent().parent().find("label").removeClass("active");var l=n.split("|");$.each(l,function(e,t){var n=r.filter("[value="+t+"]").prop("checked",true);if(n.parent().prop("tagName")=="LABEL"){n.parent().toggleClass("active")}})}}else if(r.attr("component")=="multientry"){if(n){r.empty();var s=n.split("|");$.each(s,function(e,t){r.append($("<option/>").val(t).text(t))});r.val(s).trigger("change.select2")}}else if(r.attr("component")=="multisearch"){if(n){var s=n.split("|");r.select2().val(s).trigger("change.select2")}}else if(r.length){if(n){var s=n.split("|");$(r).find("option").prop("selected",false);if(r.attr("widget")=="tselect"&&r.length==1){$.each(s,function(e,t){$(r).find("option").filter("[value="+t+"]").prop("selected",true)})}else{$.each(s,function(t,n){var i=$($(r)[t]).attr("id");tform_send_data(e,"#"+i,n,a)})}}}if(a){if(r.attr("exitaction")){tform_events_hang_exec(r.attr("exitaction"))}if(r.attr("changeaction")){tform_events_hang_exec(r.attr("changeaction"))}}}}else{tform_events_queue_push(function(){tform_send_data(e,t,n,a)})}}}catch(e){console.log(e)}}function tform_send_data_by_id(e,t,n,a){try{if($("form[name="+e+"] [id="+t+"]").length){if(typeof Adianti.formEventsCounter=="undefined"){Adianti.formEventsCounter=0}if(Adianti.formEventsCounter==0){$("form[name="+e+"] [id="+t+"]").val(n);if(a){if($("form[name="+e+"] [id="+t+"]").attr("exitaction")){tform_events_hang_exec($("form[name="+e+"] [id="+t+"]").attr("exitaction"))}if($("form[name="+e+"] [id="+t+"]").attr("changeaction")){tform_events_hang_exec($("form[name="+e+"] [id="+t+"]").attr("changeaction"))}}}else{tform_events_queue_push(function(){tform_send_data_by_id(e,t,n,a)})}}}catch(e){console.log(e)}}function tform_events_hang_exec(e){Adianti.formEventsCounter++;e=e.replace("'callback'","tform_decrease_events_counter");Function(e)()}function tform_events_queue_push(e){if(typeof Adianti.formEventsQueue=="undefined"){Adianti.formEventsQueue=new Array}Adianti.formEventsQueue.push(e);setTimeout(tform_process_events_queue,100)}function tform_process_events_queue(){if(Adianti.formEventsCounter==0&&Adianti.formEventsQueue.length>0){next=Adianti.formEventsQueue.shift();next()}if(Adianti.formEventsQueue.length>0){setTimeout(tform_process_events_queue,100)}}function tform_decrease_events_counter(){Adianti.formEventsCounter--}function tform_send_data_aggregate(e,t,n,a){try{if($("form[name="+e+"] [name="+t+"]").val()==""){$("form[name="+e+"] [name="+t+"]").val(n)}else{current_value=$("form[name="+e+"] [name="+t+"]").val();$("form[name="+e+"] [name="+t+"]").val(current_value+", "+n)}}catch(e){console.log(e)}}function tform_fire_field_actions(e,t){if($("form[name="+e+"] [name="+t+"]").attr("exitaction")){tform_events_hang_exec($("form[name="+e+"] [name="+t+"]").attr("exitaction"))}if($("form[name="+e+"] [name="+t+"]").attr("changeaction")){tform_events_hang_exec($("form[name="+e+"] [name="+t+"]").attr("changeaction"))}}function tform_hide_field(e,t){$("#"+e+' [name="'+t+'"]').closest(".tformrow").hide("fast")}function tform_show_field(e,t){$("#"+e+' [name="'+t+'"]').closest(".tformrow").show("fast")}function ttable_clone_previous_row(e){var t=$(e).closest("table");var n=t.find("tbody tr:last");var a=n.clone();tfieldlist_reset_fields(a,true);t.find("tbody").append(a);ttable_reset_counter(t)}function ttable_clone_row(e){var t=$(e).closest("tr");var n=$(e).closest("table");var a=t.prev();var i=t.clone();tfieldlist_reset_fields(i,false);t.after($(i));ttable_reset_counter(n)}function ttable_reset_counter(e){var t=0;var n=$(e).find("tr").each(function(e,n){var a=$(n).find("input,select");$(n).data("row",t);if(a.length>0){$.each(a,function(e,n){$(n).data("row",t)});t++}})}function ttable_remove_row(e){var t=$(e).closest("table");var n=t.find("tbody").find("tr:visible").length;tr=$(e).closest("tr");if(n==1){var a=tr.clone();tfieldlist_reset_fields(a,true);tr.after($(a));tr.remove()}else{tr.remove()}ttable_reset_counter(t)}function ttable_remove_row_by_id(e,t){$("#"+e).find("tr[id="+t+"]").remove()}function ttable_show_row(e,t){$("#"+e).find("tr#"+t).show()}function ttable_hide_row(e,t){$("#"+e).find("tr#"+t).hide()}function ttable_sortable_rows(e,t,n){$(document).ready(function(){$("#"+e+" tbody").sortable({handle:t,deactivate:n})})}function ttable_get_column_values(e,t){return $("#"+e+" tbody").find("tr").find("td:nth-child("+t+")").map(function(){return this.innerText}).get().join(",")}function tfieldlist_reset_fields(e,t){var n=$(e).find("input,select");var a=parseInt(Math.random()*1e8);var i=[];$.each(n,function(e,n){var r=$(n).attr("id");var o=$(n).attr("widget");var l=$(n).attr("role");if(typeof r!=="undefined"){var s=r.split("_");s.pop();var d=s.join("_");var c=d+"_"+a;var f=$(n).parent();if(i.indexOf(c)>=0){var c=d+parseInt(Math.random()*100)+"_"+a}i.push(c);if(o=="tdate"||o=="ttime"||o=="tdatetime"){$(n).attr("id",c);if(t){$(n).val("")}if(typeof $(n).attr("exitaction")!=="undefined"){$(n).attr("exitaction",$(n).attr("exitaction").replace(r,c))}if(typeof $(n).attr("onblur")!=="undefined"){$(n).attr("onblur",$(n).attr("onblur").replace(r,c))}grandparent=$(f).parent();n=$(n).detach();$(f).remove();grandparent.append(n);var u=o;if(o=="ttime"){var u="tdatetime"}var m=new RegExp(r,"g");tfieldlist_execute_scripts(grandparent,u,function(e){e=e.replace(m,c);return e})}else if(o=="tentry"){$(n).attr("id",c);if(t){$(n).val("")}if(typeof $(n).attr("exitaction")!=="undefined"){$(n).attr("exitaction",$(n).attr("exitaction").replace(r,c))}if(typeof $(n).attr("onblur")!=="undefined"){$(n).attr("onblur",$(n).attr("onblur").replace(r,c))}var m=new RegExp(r,"g");tfieldlist_execute_scripts(f,"tentry",function(e){e=e.replace(m,c);return e})}else if(o=="tspinner"){$(n).attr("id",c);if(t){$(n).val("")}if(typeof $(n).attr("exitaction")!=="undefined"){$(n).attr("exitaction",$(n).attr("exitaction").replace(r,c))}if(typeof $(n).attr("onblur")!=="undefined"){$(n).attr("onblur",$(n).attr("onblur").replace(r,c))}grandparent=$(f).parent();n=$(n).detach();$(f).remove();grandparent.append(n);var m=new RegExp(r,"g");tfieldlist_execute_scripts(grandparent,"tspinner",function(e){e=e.replace(m,c);return e})}else if(o=="tcolor"){$(n).attr("id",c);if(t){$(n).val("")}if(typeof $(n).attr("exitaction")!=="undefined"){$(n).attr("exitaction",$(n).attr("exitaction").replace(r,c))}if(typeof $(n).attr("onblur")!=="undefined"){$(n).attr("onblur",$(n).attr("onblur").replace(r,c))}grandparent=$(f).parent();var m=new RegExp(r,"g");tfieldlist_execute_scripts(grandparent,"tcolor",function(e){e=e.replace(m,c);return e})}else if(o=="thidden"){$(n).attr("id",c);if(t){$(n).val("")}var m=new RegExp(r,"g");tfieldlist_execute_scripts(f,"thidden",function(e){e=e.replace(m,c);return e})}else if(o=="tdbmultisearch"||o=="tdbuniquesearch"){$(n).attr("id",c);$(f).find(".select2-container").remove();var m=new RegExp(r,"g");tfieldlist_execute_scripts(f,"tdbmultisearch",function(e){e=e.replace(m,c);return e});if(t){setTimeout(function(){$(n).val("").trigger("change.select2")},10)}}else if(o=="tmultisearch"||o=="tuniquesearch"){$(n).attr("id",c);$(f).find(".select2-container").remove();var m=new RegExp(r,"g");tfieldlist_execute_scripts(f,"tmultisearch",function(e){e=e.replace(m,c);return e});if(t){setTimeout(function(){$(n).val("").trigger("change.select2")},10)}}else if(o=="tcombo"){$(n).attr("id",c);if(t){$(n).val("")}if(l=="tcombosearch"){$(f).find(".select2-container").remove()}if(typeof $(n).attr("changeaction")!=="undefined"){$(n).attr("changeaction",$(n).attr("changeaction").replace(r,c))}if(typeof $(n).attr("onchange")!=="undefined"){$(n).attr("onchange",$(n).attr("onchange").replace(r,c))}var m=new RegExp(r,"g");tfieldlist_execute_scripts(f,"tcombo",function(e){e=e.replace(m,c);return e})}}if(o=="tradiobutton"){$(n).parent().removeClass("active")}else if(o=="tcheckbutton"){$(n).parent().removeClass("active")}})}function tfieldlist_execute_scripts(e,t,n){var a=$(e).find("script");$.each(a,function(e,a){var i=$(a).text();i=n(i);if(i.trim().split("_")[0]==t){$(a).text(i);setTimeout(function(){new Function(i)()},10)}})}function tfieldlist_clear(e){ttable_clone_previous_row($("[name="+e+"] tbody"));var t=$("[name="+e+"] tbody").find("tr").length-1;$("[name="+e+"] tbody").find("tr").each(function(e,n){if(e<t){ttable_remove_row(n)}})}function tfieldlist_add_rows(e,t){for(n=1;n<=t;n++){setTimeout(function(){ttable_clone_previous_row($("[name="+e+"] tbody"))},50*n)}}function tfieldlist_clear_rows(e,t,n){var a=$("[name="+e+"] tbody").find("tr").length;n=(n==0?a:n)+t;if(n>=a){ttable_clone_previous_row($("[name="+e+"] tbody").find("tr:last"));n=a}$("[name="+e+"] tbody").find("tr").each(function(e,a){if(e>=t&&e<n){$(a).remove()}})}function tdatagrid_inlineedit(e){$(function(){$(".inlineediting").editInPlace({callback:function(t,n){__adianti_load_page($(this).attr("action")+e+"&key="+$(this).attr("key")+"&"+$(this).attr("pkey")+"="+$(this).attr("key")+"&field="+$(this).attr("field")+"&value="+encodeURIComponent(n));return n},show_buttons:false,text_size:20,params:column=name})})}function tdatagrid_add_serialized_row(e,t){$("#"+e+" > tbody:last-child").append(t)}function tdatagrid_enable_groups(){$("[id^=tdatagrid_] tr[level]").not("[x=1]").css("cursor","pointer").attr("x","1").click(function(){if(!$(this).data("child-visible")){$(this).data("child-visible",false)}$(this).data("child-visible",!$(this).data("child-visible"));if($(this).data("child-visible")){$(this).siblings('[childof^="'+$(this).attr("level")+'"]').hide("fast")}else{$(this).siblings('[childof^="'+$(this).attr("level")+'"]').show("fast")}})}function tbutton_enable_field(e,t){setTimeout(function(){$("button[name="+t+"]").removeAttr("disabled");$("button[name=btn_"+t+"]").removeAttr("disabled");$("#tbutton_"+t).removeAttr("disabled")},1)}function tbutton_disable_field(e,t){setTimeout(function(){$("button[name="+t+"]").attr("disabled",true);$("button[name=btn_"+t+"]").attr("disabled",true);$("#tbutton_"+t).attr("disabled",true)},1)}function tcheckgroup_enable_field(e,t){setTimeout(function(){$("form[name="+e+"] [checkgroup="+t+"]").removeAttr("disabled");$("form[name="+e+"] [checkgroup="+t+"]").parent().removeAttr("disabled")},1)}function tcheckgroup_disable_field(e,t){setTimeout(function(){$("form[name="+e+"] [checkgroup="+t+"]").attr("disabled","");$("form[name="+e+"] [checkgroup="+t+"]").parent().attr("disabled","")},1)}function tcheckgroup_clear_field(e,t){setTimeout(function(){$("form[name="+e+"] [checkgroup="+t+"]").attr("checked",false)},1)}function tcolor_enable_field(e,t){try{setTimeout(function(){$("form[name="+e+"] [name="+t+"]").closest(".color-div").colorpicker("enable");$("form[name="+e+"] [name="+t+"]").removeClass("tfield_disabled")},1)}catch(e){console.log(e)}}function tcolor_disable_field(e,t){try{setTimeout(function(){$("form[name="+e+"] [name="+t+"]").closest(".color-div").colorpicker("disable");$("form[name="+e+"] [name="+t+"]").addClass("tfield_disabled")},1)}catch(e){console.log(e)}}function tcolor_start(e,t,n){var a=0;if(typeof n!="undefined"){$("#"+e).closest(".color-div").colorpicker().on("changeColor",function(e){if(e.timeStamp-a>500){n(e.color);a=e.timeStamp}});$("#"+e).click(function(){$("#"+e).closest(".color-div").colorpicker("show")})}else{$("#"+e).closest(".color-div").colorpicker()}if(t!=="undefined"){$("#"+e).closest(".color-div").width(t)}$(".colorpicker").css("z-index",1e6)}function ticon_enable_field(e,t){try{setTimeout(function(){$("form[name="+e+'] div[name="block_'+t+'"]').remove()},1)}catch(e){console.log(e)}}function ticon_disable_field(e,t){try{input=$("form[name="+e+"] [name="+t+"]").closest(".input-group");setTimeout(function(){$("form[name="+e+'] div[name="block_'+t+'"]').remove()},19);setTimeout(function(){input.prepend('<div name="block_'+t+'" style="position:absolute; width:'+input.width()+"px; height:"+input.height()+'px; background: #c0c0c0; opacity:0.5;"></div>')},20)}catch(e){console.log(e)}}function ticon_start(e,t){if(t){$("#"+e).iconpicker().on("iconpickerUpdated",function(e){t($(this).val())})}else{$("#"+e).iconpicker()}}function tcombo_enable_field(e,t){if(typeof e!="undefined"&&e!=""){e='form[name="'+e+'"] '}else{e=""}var n='[name="'+t+'"]';if(t.indexOf("[")==-1&&$("#"+t).length>0){var n="#"+t}try{$(e+n).attr("onclick",null);$(e+n).css("pointer-events","auto");$(e+n).removeClass("tcombo_disabled").addClass("tcombo")}catch(e){console.log(e)}}function tcombo_disable_field(e,t){if(typeof e!="undefined"&&e!=""){e='form[name="'+e+'"] '}else{e=""}var n='[name="'+t+'"]';if(t.indexOf("[")==-1&&$("#"+t).length>0){var n="#"+t}try{$(e+n).attr("onclick","return false");$(e+n).attr("tabindex","-1");$(e+n).css("pointer-events","none");$(e+n).removeClass("tcombo").addClass("tcombo_disabled")}catch(e){console.log(e)}}function tcombo_add_option(e,t,n,a){var n=n.replace(/"/g,"");if(typeof e!="undefined"&&e!=""){e='form[name="'+e+'"] '}else{e=""}var i='select[name="'+t+'"]';if(t.indexOf("[")==-1&&$("#"+t).length>0){var i="#"+t}var r=$(e+i).find("optgroup");if(r.length>0){$('<option value="'+n+'">'+a+"</option>").appendTo(r.last())}else{$('<option value="'+n+'">'+a+"</option>").appendTo(e+i)}}function tcombo_create_opt_group(e,t,n){if(typeof e!="undefined"&&e!=""){e='form[name="'+e+'"] '}else{e=""}var a='[name="'+t+'"]';if($("#"+t).length>0){var a="#"+t}$('<optgroup label="'+n+'"></optgroup>').appendTo(e+a)}function tcombo_clear(e,t,n){if(typeof n=="undefined"){n=true}if(typeof e!="undefined"&&e!=""){var e='form[name="'+e+'"] '}else{var e=""}var t=$(e+'[name="'+t+'"]');if(t.attr("role")=="tcombosearch"){if(t.find("option:not(:disabled)").length>0){t.val("").empty().trigger("change.select2")}}else{t.val(false);t.html("")}if(n){if(t.attr("changeaction")){tform_events_hang_exec(t.attr("changeaction"))}}}function tcombo_enable_search(e,t){$(e).removeAttr("onchange");$(e).select2({allowClear:true,placeholder:t,templateResult:function(e){if(/<[a-z][\s\S]*>/i.test(e.text)){return $("<span>"+e.text+"</span>")}else{return e.text}},templateSelection:function(e){if(/<[a-z][\s\S]*>/i.test(e.text)){return $("<span>"+e.text+"</span>")}else{return e.text}}}).on("change",function(t){new Function($(e).attr("changeaction"))()})}function tcombocombined_enable_field(e,t){try{$("form[name="+e+"] [name="+t+"]").attr("disabled",false)}catch(e){}try{$("form[name="+e+"] [name="+t+"]").removeClass("tfield_disabled").addClass("tfield")}catch(e){}try{$("form[name="+e+"] [name="+t+"]").next().attr("disabled",false)}catch(e){}try{$("form[name="+e+"] [name="+t+"]").next().removeClass("tcombo_disabled").addClass("tcombo")}catch(e){}}function tcombocombined_disable_field(e,t){try{$("form[name="+e+"] [name="+t+"]").attr("disabled",true)}catch(e){}try{$("form[name="+e+"] [name="+t+"]").removeClass("tfield").addClass("tfield_disabled")}catch(e){}try{$("form[name="+e+"] [name="+t+"]").next().attr("disabled",true)}catch(e){}try{$("form[name="+e+"] [name="+t+"]").next().removeClass("tcombo").addClass("tcombo_disabled")}catch(e){}}function tcombocombined_clear_field(e,t){try{$("form[name="+e+"] [name="+t+"]").val("")}catch(e){}try{$("form[name="+e+"] [name="+t+"]").next().val("")}catch(e){}}function tdate_enable_field(e,t){try{$("form[name="+e+"] [name="+t+"]").attr("disabled",false);$("form[name="+e+"] [name="+t+"]").removeClass("tfield_disabled").addClass("tfield");$("form[name="+e+"] [name="+t+"]").css("border-right","0")}catch(e){console.log(e)}setTimeout(function(){$("form[name="+e+"] [name="+t+"]").next().show()},1)}function tdate_disable_field(e,t){try{$("form[name="+e+"] [name="+t+"]").attr("disabled",true);$("form[name="+e+"] [name="+t+"]").removeClass("tfield").addClass("tfield_disabled");$("form[name="+e+"] [name="+t+"]").css("border-right","1px solid gray")}catch(e){console.log(e)}setTimeout(function(){$("form[name="+e+"] [name="+t+"]").next().hide()},1)}function tdate_start(e,t,n,a,i){$(e).wrap('<div class="tdate-group date">');$(e).after('<span class="btn btn-default tdate-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>');atributes={format:t,todayBtn:"linked",language:n,calendarWeeks:false,autoclose:true,todayHighlight:true,orientation:"bottom auto"};i=Object.assign(atributes,JSON.parse(i));$(e).closest(".tdate-group").datepicker(i).on("changeDate",function(t){if($(e).attr("exitaction")){new Function($(e).attr("exitaction"))()}}).on("show",function(){$(".datepicker").on("click",function(e){e.stopPropagation()})});if(a!=="undefined"){$(e).closest(".tdate-group").width(a)}}function tdatetime_start(e,t,n,a,i){$(e).wrap('<div class="tdate-group tdatetimepicker input-append date">');$(e).after('<span class="add-on btn btn-default tdate-group-addon"><i class="fa fa-clock-o icon-th"></i></span>');atributes={autoclose:true,todayBtn:true,todayHighlight:true,format:t,language:n};i=Object.assign(atributes,JSON.parse(i));$(e).closest(".tdate-group").datetimepicker(i).on("change.dp",function(t){if($(e).attr("exitaction")){new Function($(e).attr("exitaction"))()}}).on("show",function(){$(".datepicker").on("click",function(e){e.stopPropagation()})});if(a!=="undefined"){$(e).closest(".tdate-group").width(a)}}function tdbentry_start(e,t,n){$('input[name="'+e+'"]').autocomplete({serviceUrl:t,minChars:n})}function tentry_mask(e,t,n){var a,i,r,o,l,s;a=e.value;if(typeof a=="undefined"){return true}if($(e).attr("forceupper")=="1"){a=a.toUpperCase()}if($(e).attr("forcelower")=="1"){a=a.toLowerCase()}if(document.all){keyCode=t.keyCode}else if(document.layers){keyCode=t.which}else{keyCode=t.which}if(keyCode==8||t.keyCode==9||t.keyCode==13){return true}o="";var d=0;if(n.charAt(1)=="!"){s=e.value.length+1}else{s=n.length}for(i=0;i<s-1;i++){maskChar=n.charAt(i);valueChar=a.charAt(d);if(i<=a.length){if((maskChar=="-"||maskChar=="_"||maskChar=="."||maskChar=="/"||maskChar=="\\"||maskChar==":"||maskChar=="|"||maskChar=="("||maskChar==")"||maskChar=="["||maskChar=="]"||maskChar=="{"||maskChar=="}")&maskChar!==valueChar){o+=maskChar}else{o+=valueChar;d++}}}e.value=o;l=e.value.length;if(n.charAt(1)=="!"){maskChar=n.charAt(0)}else{maskChar=n.charAt(l)}switch(maskChar){case"A":case"a":return keyCode>47&&keyCode<58||keyCode>64&&keyCode<91||keyCode>96&&keyCode<123;break;case"S":case"s":return keyCode>64&&keyCode<91||keyCode>96&&keyCode<123;break;case"9":return keyCode>47&&keyCode<58;break}return true}function tentry_upper(e){if(typeof e.value!=="undefined"){e.value=e.value.toUpperCase()}}function tentry_lower(e){if(typeof e.value!=="undefined"){e.value=e.value.toLowerCase()}}function tentry_autocomplete(e,t){var n;var a='input[name="'+e+'"]';if($("#"+e).length>0){var a="#"+e}$(a).autocomplete({lookup:t,onSelect:function(){var e=$(this).data("val");var t=$(this).val();$(this).data("val",t);$(a).removeAttr("onblur");if(e!==t){if($(a).attr("exitaction")){string_callback=$(a).attr("exitaction");Function(string_callback)()}}}})}function tentry_numeric_mask(e,t,n,a){var i='input[name="'+e+'"]';if($("#"+e).length>0){var i="#"+e}$(i).iMask({type:"number",decDigits:t,decSymbol:n,groupSymbol:a});if($(i).prop("readonly")==true){$(i).off("keydown")}}function texpander_start(){$(".texpander-container").click(function(e){e.stopPropagation()})}function tfield_enable_field(e,t){try{$("form[name="+e+"] [name="+t+"]").attr("readonly",false);$("form[name="+e+"] [name="+t+"]").removeClass("tfield_disabled").addClass("tfield")}catch(e){console.log(e)}}function tfield_disable_field(e,t){try{$("form[name="+e+"] [name="+t+"]").attr("readonly",true);$("form[name="+e+"] [name="+t+"]").removeClass("tfield").addClass("tfield_disabled")}catch(e){console.log(e)}}function tfield_clear_field(e,t){try{$("form[name="+e+"] [name="+t+"]").val("")}catch(e){console.log(e)}}function tfield_transfer_value(e,t,n){if($(e).attr("type")=="checkbox"){var a=$(e).attr("value");var i=$(e).closest(n).find(t).val();if($(e).is(":checked")){i=i+a+","}else{i=i.replace(a+",","")}$(e).closest(n).find(t).val(i)}else{var i=$(e).val();$(e).closest(n).find(t).val(i)}}function ttreeview_start(e,t){$(e).treeview({persist:"location",animated:"fast",collapsed:t})}function FileUploader(e,t,n,a,i){this.field_name=$("#"+e).attr("receiver");this.input_id=e;this.service_action=n;this.parent_container=$("#"+t);this.complete_action=a;this.file_handling=i;this.obj_file=document.getElementById(this.input_id);var r=this;this.createStatusRow=function(){var e=r.parent_container.find("[widget=tfile]")[0];var t=$(e).css("width");var n=$("<div />",{class:"tfile_row_wrapper",style:"display:none"});var a=$("<div />",{class:"tfile_row_1"});var i=$("<div />",{class:"tfile_row_2"});var o=$("<div />",{class:"tfile_link_wrapper",style:"width: calc("+t+" - 25px)"});var l=$("<span />",{class:"tfile_del_icon fa fa-minus-circle gray",title:"Remover"});var s=$("<div />",{class:"progress-bar progress-bar-success",style:"width: 0%; height: 2px;"});var d=$("<input />",{type:"hidden",name:r.field_name});r.file_row_wrapper=n;r.file_input_hidden=d;r.file_progress_bar=s;r.file_link_wrapper=o;r.parent_container.children(".tfile_row_wrapper").remove();r.parent_container.append(n);n.append(a);n.append(i);a.append(d,o,l);i.append(s);$(l).click(function(){var e=r.getData();n.hide();r.parent_container.children("i").attr({class:"",title:""});r.parent_container.find("[widget=tfile]").css("padding-left","5px");e.delFile=e.fileName;if(e.delFile==e.newFile){e=""}r.setData(e)});return n};this.showFile=function(e){if(typeof e=="undefined"){var e=this.getData()}var t=e.fileName;if(t){var n=r.file_row_wrapper;var a=n.find(".tfile_link_wrapper");n.find(".progress-bar").css("width","100%");if($.inArray(t.split(".").pop(),["png","jpg"])>-1){var i='<div class="popover" role="tooltip" style="z-index:100000;max-width:800px"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"><div class="data-content"></div></div></div>';var o=$("<a />",{href:"download.php?file="+t,target:"_blank"});o.popover({trigger:"hover",content:'<img style="max-width:460px" src="'+"download.php?file="+t+'">',html:true,container:"body",template:i})}else{var o=$("<a />",{href:"download.php?file="+t,target:"_blank"})}r.file_row_wrapper.show();o.append(t);a.html(o)}};this.getData=function(){var e=decodeURIComponent(r.file_input_hidden.val());var t="";try{t=e?JSON.parse(e):{}}catch(e){t={}}return t};this.setData=function(e){if(e){$(r.file_input_hidden).val(encodeURIComponent(JSON.stringify(e)))}else{$(r.file_input_hidden).val("")}};this.supportAjaxUploadWithProgress=function(){return this.supportFileAPI()&&this.supportAjaxUploadProgressEvents()&&this.supportFormData()};this.supportFileAPI=function(){var e=document.createElement("INPUT");e.type="file";return"files"in e};this.supportAjaxUploadProgressEvents=function(){var e=new XMLHttpRequest;return!!(e&&"upload"in e&&"onprogress"in e.upload)};this.supportFormData=function(){return!!window.FormData};this.initFileUpload=function(){if(r.file_handling){}if(this.supportAjaxUploadWithProgress()){var e=new FormData;var t=r.obj_file.files[0];e.append("fileName",t);this.sendXHRequest(e,r.service_action)}};this.sendXHRequest=function(e,t){var n=new XMLHttpRequest;n.upload.addEventListener("loadstart",this.onLoadStart,false);n.upload.addEventListener("progress",this.onProgress,false);n.upload.addEventListener("load",this.onLoad,false);n.addEventListener("readystatechange",this.onReadyStateChange,false);n.open("POST",t,true);n.send(e)};this.onLoadStart=function(e){if(r.parent_container.children("i").length==0){r.parent_container.prepend($("<i>"))}if(r.file_handling){r.file_row_wrapper.show()}r.parent_container.find("[widget=tfile]").css("padding-left","20px");r.parent_container.children("i").attr({class:"fa fa-spinner fa-spin fa-fw blue file-response-icon",title:"..."})};this.onLoad=function(e){};this.onProgress=function(e){if(e.lengthComputable&&r.file_handling){var t=Math.round(e.loaded*100/e.total);r.file_progress_bar.css("width",t+"%").css("height",2);r.file_link_wrapper.html(t+"%")}};this.onReadyStateChange=function(e){var t=null;try{t=e.target.status}catch(e){return}if(t=="200"&&e.target.readyState=="4"&&e.target.responseText){try{var n=JSON.parse(e.target.responseText);if(n.type=="success"){if(r.file_handling){var a=r.getData();if(a.fileName){a.delFile=a.fileName}a.newFile="tmp/"+n.fileName;a.fileName="tmp/"+n.fileName;r.setData(a);r.showFile(a)}else{var i=$("#"+r.input_id).parent().children("input[type=hidden]");$(i).val(n.fileName)}r.showMessage("success","Sucesso");if(this.readyState==4&&typeof r.complete_action=="function"){r.complete_action()}}else{if(r.file_handling){r.file_row_wrapper.remove()}r.showMessage("error",n.msg)}}catch(t){if(r.file_handling){r.file_row_wrapper.remove()}if(typeof n=="undefined"){r.showMessage("error",e.target.responseText)}else{r.showMessage("error",t)}}}};this.showMessage=function(e,t){if(e=="success"){r.parent_container.find("[widget=tfile]").css("padding-left","20px");r.parent_container.children("i").attr({class:"fa fa-check-circle-o green file-response-icon",title:t})}else if(e=="error"){r.parent_container.find("[widget=tfile]").css("padding-left","20px");r.parent_container.children("i").attr({class:"fa fa-exclamation-circle red file-response-icon",title:t})}}}function tfile_start(e,t,n,a,i){$(function(){var r=new FileUploader(e,t,n,a,i);$("#"+e).change(function(){r.initFileUpload()});if(i){var o=$("#"+e).parent().children("input[type=hidden]");r.createStatusRow();if($(o).val()){r.setData(JSON.parse(decodeURIComponent($(o).val())))}r.showFile();$(o).remove()}})}function tfile_enable_field(e,t){try{$("form[name="+e+"] [name=file_"+t+"]").removeAttr("disabled");$("form[name="+e+"] [name=file_"+t+"]").removeClass("tfield_disabled").addClass("tfield")}catch(e){console.log(e)}}function tfile_disable_field(e,t){try{$("form[name="+e+"] [name=file_"+t+"]").attr("disabled",true);$("form[name="+e+"] [name=file_"+t+"]").removeClass("tfield").addClass("tfield_disabled")}catch(e){console.log(e)}}function tfile_clear_field(e,t){try{$("form[name="+e+"] [name="+t+"]").val("");$("form[name="+e+"] [name=file_"+t+"]").val("")}catch(e){console.log(e)}}function tfile_update_download_link(e){if($("#view_"+e).length){value=$("[name="+e+"]").val();$("#view_"+e).attr("href","download.php?file=tmp/"+value);$("#view_"+e).html("tmp/"+value)}}function MultiFileUploader(e,t,n,a,i,r){this.field_name=$("#"+e).attr("receiver");this.obj_file=t;this.service_action=n;this.complete_action=i;this.file_handling=r;this.parent_container=$("#"+a);var o=this;this.createStatusRow=function(){var e=o.parent_container.find("[widget=tmultifile]")[0];var t=$(e).css("width");var n=$("<div />",{class:"tfile_row_wrapper"});var a=$("<div />",{class:"tfile_row_1"});var i=$("<div />",{class:"tfile_row_2"});var r=$("<div />",{class:"tfile_link_wrapper",style:"width: calc("+t+" - 25px)"});var l=$("<span />",{class:"tfile_del_icon fa fa-minus-circle gray",title:"Remover"});var s=$("<div />",{class:"progress-bar progress-bar-success",style:"width: 0%; height: 2px;"});var d=$("<input />",{type:"hidden",name:o.field_name+"[]"});o.file_row_wrapper=n;o.file_input_hidden=d;o.file_progress_bar=s;o.file_link_wrapper=r;o.parent_container.append(n);n.append(a);n.append(i);a.append(d,r,l);i.append(s);$(l).click(function(){var e=o.getData();n.hide();o.parent_container.children("i").attr({class:"",title:""});o.parent_container.find("[widget=tmultifile]").css("padding-left","5px");e.delFile=e.fileName;if(e.delFile==e.newFile){e=""}o.setData(e)});return n};this.showFile=function(e){if(typeof e=="undefined"){var e=this.getData()}var t=e.fileName;if(t){var n=o.file_row_wrapper;var a=n.find(".tfile_link_wrapper");n.find(".progress-bar").css("width","100%");if($.inArray(t.split(".").pop(),["png","jpg"])>-1){var i='<div class="popover" role="tooltip" style="z-index:100000;max-width:800px"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"><div class="data-content"></div></div></div>';var r=$("<a />",{href:"download.php?file="+t,target:"_blank"});r.popover({trigger:"hover",content:'<img style="max-width:460px" src="'+"download.php?file="+t+'">',html:true,container:"body",template:i})}else{var r=$("<a />",{href:"download.php?file="+t,target:"_blank"})}r.append(t);a.html(r)}};this.getData=function(){var e=decodeURIComponent(o.file_input_hidden.val());var t="";try{t=e?JSON.parse(e):{}}catch(e){t={}}return t};this.setData=function(e){if(e){$(o.file_input_hidden).val(encodeURIComponent(JSON.stringify(e)))}else{$(o.file_input_hidden).val("")}};this.supportAjaxUploadWithProgress=function(){return this.supportFileAPI()&&this.supportAjaxUploadProgressEvents()&&this.supportFormData()};this.supportFileAPI=function(){var e=document.createElement("INPUT");e.type="file";return"files"in e};this.supportAjaxUploadProgressEvents=function(){var e=new XMLHttpRequest;return!!(e&&"upload"in e&&"onprogress"in e.upload)};this.supportFormData=function(){return!!window.FormData};this.initFileUpload=function(){this.createStatusRow();if(this.supportAjaxUploadWithProgress()){var e=new FormData;var t=o.obj_file;e.append("fileName",t);this.sendXHRequest(e,o.service_action)}};this.sendXHRequest=function(e,t){var n=new XMLHttpRequest;n.upload.addEventListener("loadstart",this.onLoadStart,false);n.upload.addEventListener("progress",this.onProgress,false);n.upload.addEventListener("load",this.onLoad,false);n.addEventListener("readystatechange",this.onReadyStateChange,false);n.open("POST",t,true);n.send(e)};this.onLoadStart=function(e){if(o.parent_container.children("i").length==0){o.parent_container.prepend($("<i>"))}o.parent_container.find("[widget=tmultifile]").css("padding-left","20px");o.parent_container.children("i").attr({class:"fa fa-spinner fa-spin fa-fw blue file-response-icon",title:"..."})};this.onLoad=function(e){};this.onProgress=function(e){if(e.lengthComputable){var t=Math.round(e.loaded*100/e.total);o.file_progress_bar.css("width",t+"%").css("height",2);o.file_link_wrapper.html(t+"%")}}
;this.onReadyStateChange=function(e){var t=null;try{t=e.target.status}catch(e){return}if(t=="200"&&e.target.readyState=="4"&&e.target.responseText){try{var n=JSON.parse(e.target.responseText);if(n.type=="success"){if(o.file_handling){var a=o.getData();a.newFile="tmp/"+n.fileName;a.fileName="tmp/"+n.fileName;o.setData(a);o.showFile(a)}else{o.file_input_hidden.val(n.fileName);o.file_link_wrapper.html(n.fileName)}o.showMessage("success","Sucesso");if(this.readyState==4&&typeof o.complete_action=="function"){o.complete_action()}}else{o.file_row_wrapper.remove();o.showMessage("error",n.msg)}}catch(t){o.file_row_wrapper.remove();if(typeof n=="undefined"){o.showMessage("error",e.target.responseText)}else{o.showMessage("error",t)}}}};this.showMessage=function(e,t){if(e=="success"){o.parent_container.find("[widget=tmultifile]").css("padding-left","20px");o.parent_container.children("i").attr({class:"fa fa-check-circle-o green file-response-icon",title:t})}else if(e=="error"){o.parent_container.find("[widget=tmultifile]").css("padding-left","20px");o.parent_container.children("i").attr({class:"fa fa-exclamation-circle red file-response-icon",title:t})}}}function tmultifile_start(e,t,n,a,i){$(function(){$("#"+e).change(function(){$.each($(this).prop("files"),function(r,o){var l=new MultiFileUploader(e,o,n,t,a,i);l.initFileUpload()})});if(i){$("#"+e).parent().children("input[type=hidden]").each(function(r,o){var l=new MultiFileUploader(e,null,n,t,a,i);l.createStatusRow();if($(o).val()){l.setData(JSON.parse(decodeURIComponent($(o).val())))}l.showFile();$(o).remove()})}})}function tmultifile_enable_field(e,t){try{$("form[name="+e+"] [name='file_"+t+"[]']").removeAttr("disabled");$("form[name="+e+"] [name='file_"+t+"[]']").removeClass("tfield_disabled").addClass("tfield")}catch(e){console.log(e)}}function tmultifile_disable_field(e,t){try{$("form[name="+e+"] [name='file_"+t+"[]']").attr("disabled",true);$("form[name="+e+"] [name='file_"+t+"[]']").removeClass("tfield").addClass("tfield_disabled")}catch(e){console.log(e)}}function tmultifile_clear_field(e,t){try{$("form[name="+e+"] [name='"+t+"[]']").val("");$("form[name="+e+"] [name='file_"+t+"[]']").val("")}catch(e){console.log(e)}}function thtmleditor_enable_field(e,t){setTimeout(function(){$("form[name="+e+"] [name="+t+"]").next().find(".note-editable").attr("contenteditable",true)},1)}function thtmleditor_disable_field(e,t){setTimeout(function(){$("form[name="+e+"] [name="+t+"]").next().find(".note-editable").attr("contenteditable",false)},1)}function thtmleditor_clear_field(e,t){setTimeout(function(){$("form[name="+e+"] [name="+t+"]").code("")},1)}function thtmleditor_start(e,t,n,a){$("#"+e).summernote({width:t,height:n,lang:a});if(typeof $("#"+e).next(".note-editor")[0]!=="undefined"){var i=$("#"+e).next(".note-editor")[0];$(i).css("margin",$("#"+e).css("margin"))}}function tmenubar_start(){$(document).ready(function(){$(".dropdown-toggle").dropdown()})}function MultiField(e,t,n){this.formFieldsName=Array();this.formFieldsMandatory=Array();this.formFieldsAlias=Array();this.formPostFields=Array();this.storeButton=null;this.deleteButton=null;this.cancelButton=null;this.inputResult=null;this.addEndCol=function(e){if(document.all)return;var t=e.getElementsByTagName("THEAD")[0].getElementsByTagName("TR");for(var n=0;n<t.length;n++){var a=t[n].insertCell(-1);a.innerHTML="&nbsp;";a.setAttribute("data","");a.style.width="13px";a.width="13";a.className="multifield_header"}};this.initmultifield=function(e,t,n){t=t+"";n=n+"";var a=document.getElementById(e);if(a){this.mtf=a;var r=this;if(navigator.userAgent.indexOf("MSIE")>=0){a.parentNode.style.overflowY="auto"}if(t.indexOf("%")>=0){a.style.width=t;a.parentNode.style.width=t}else{a.style.width=t+"px";a.parentNode.style.width=t+"px"}if(n.indexOf("%")>=0){a.parentNode.style.height=n}else{a.parentNode.style.height=n+"px"}this.addEndCol(a);a.cellSpacing=0;a.cellPadding=0;var o=a.getElementsByTagName("THEAD")[0];var l=a.getElementsByTagName("TBODY")[0];for(d=0;d<l.rows.length;d++){l.rows[d].onmousedown=function(){r.highlightSelectedRow(this);return false};l.rows[d].onmouseup=function(){return false};l.rows[d].onselectstart=function(){return false};var s=l.rows[d];for(i=0;i<s.cells.length;i++){s.cells[i].className="multifieldtd"}}for(var d=1;d<a.rows.length;d++){a.rows[d].onmouseover=this.highlightDataRow;a.rows[d].onmouseout=this.deHighlightDataRow}}};this.highlightDataRow=function(){this.className="tmultifield_over";if(document.all){var e=this.parentNode.parentNode.parentNode;var t=e.getElementsByTagName("TR")[0];t.style.top=e.scrollTop+"px"}};this.deHighlightDataRow=function(){this.className=null;if(document.all){var e=this.parentNode.parentNode.parentNode;var t=e.getElementsByTagName("TR")[0];t.style.top=e.scrollTop+"px"}};this.highlightSelectedRow=function(e){if(this.selectedRow!=null){this.selectedRow.style.backgroundColor=""}e.style.backgroundColor="#88FF88";this.selectedRow=e;var t;for(t=0;t<this.formFieldsName.length;t++){var n=document.getElementsByName(this.formFieldsName[t])[0];var a=e.cells[t].innerHTML;if(n.getAttribute("auxiliar")!="1"){if(n.type=="radio"){$("input[type=radio][name="+n.name+"][value="+a+"]").click()}else if(n.getAttribute("component")=="multisearch"){objectId=n.getAttribute("id");$("#"+objectId).select2("val","");if(e.cells[t].getAttribute("data")){try{$("#"+objectId).select2("data",JSON.parse(e.cells[t].getAttribute("data")))}catch(e){}}}else{n.value=a}}if(typeof n.onchange=="function")n.onchange()}var i=this;if(this.storeButton){this.storeButton.onclick=function(){i.updateRowValuesFromFormFields(e);i.unselectRow();if(i.cancelButton)i.cancelButton.setAttribute("disabled","1");if(i.deleteButton)i.deleteButton.setAttribute("disabled","1");this.onclick=function(){i.addRowFromFormFields()}}}if(this.deleteButton){this.deleteButton.removeAttribute("disabled");this.deleteButton.onclick=function(){i.deleteRow();if(i.cancelButton)i.cancelButton.setAttribute("disabled","1");if(i.deleteButton)i.deleteButton.setAttribute("disabled","1");if(i.storeButton){i.storeButton.onclick=function(){i.addRowFromFormFields()}}}}if(this.cancelButton){this.cancelButton.removeAttribute("disabled");this.cancelButton.onclick=function(){i.unselectRow();if(i.cancelButton)i.cancelButton.setAttribute("disabled","1");if(i.deleteButton)i.deleteButton.setAttribute("disabled","1");if(i.storeButton){i.storeButton.onclick=function(){i.addRowFromFormFields()}}}}};this.addRowFromFormFields=function(){var e=document.createElement("TR");var t=this;e.onmousedown=function(){t.highlightSelectedRow(this);return false};e.onmouseup=function(){return false};e.onmouseover=this.highlightDataRow;e.onmouseout=this.deHighlightDataRow;for(var n=0;n<this.formFieldsName.length;n++){var a=document.createElement("TD");a.width=this.mtf.getElementsByTagName("THEAD")[0].getElementsByTagName("TR")[0].getElementsByTagName("TD")[n].width;a.innerHTML=this.getFieldValue(this.formFieldsName[n]);a.setAttribute("data",this.getFieldData(this.formFieldsName[n]));if(a.innerHTML.trim()==""&&this.formFieldsMandatory[n]){alert(this.mandatoryMessage.replace("^1",this.mtf.tHead.rows[0].cells[n].innerHTML));document.getElementsByName(this.formFieldsName[n])[0].focus();return false}e.appendChild(a)}this.mtf.tBodies[0].appendChild(e);if(!document.all)e.insertCell(-1);this.clearFormFields();return true};this.updateRowValuesFromFormFields=function(e){var t;for(t=0;t<this.formFieldsName.length;t++){var n=this.getFieldValue(this.formFieldsName[t]);if(n.trim()==""&&this.formFieldsMandatory[t]){alert(this.mandatoryMessage.replace("^1",this.mtf.tHead.rows[0].cells[t].innerHTML));document.getElementsByName(this.formFieldsName[t])[0].focus();return false}e.cells[t].innerHTML=n;e.cells[t].setAttribute("data",this.getFieldData(this.formFieldsName[t]))}this.clearFormFields();return true};this.unselectRow=function(){if(this.selectedRow){this.selectedRow.onmouseout();this.selectedRow.style.backgroundColor="";this.clearFormFields();this.selectedRow=null}};this.deleteRow=function(){if(this.selectedRow){var e=this.selectedRow;this.unselectRow();this.mtf.tBodies[0].removeChild(e)}};this.clearFormFields=function(){for(x=0;x<this.formFieldsName.length;x++){var e=document.getElementsByName(this.formFieldsName[x]);switch(e[0].type){case"text":e[0].value="";break;case"textarea":e[0].value="";break;case"hidden":if(e[0].getAttribute("component")=="multisearch"){objectId=e[0].getAttribute("id");return $("#"+objectId).select2("val","")}break;case"radio":for(var t=0;t<e.length;t++){e[t].checked=false}break;case"select-one":e[0].selectedIndex=-1;try{e[0].value=0}catch(e){}break;case"select-multiple":for(var t=0;t<e[0].options.length;t++){e[0].options[t].selected=false}break;case"checkbox":e[0].checked=false;break}}};this.getFieldData=function(e){var t=document.getElementsByName(e);if(t[0].getAttribute("component")=="multisearch"){return JSON.stringify($("#"+objectId).select2("data"))}else{return this.getFieldValue(e)}};this.getFieldValue=function(e){var t=document.getElementsByName(e);if(t){switch(t[0].type){case"text":return t[0].value;break;case"textarea":return t[0].value;break;case"hidden":if(t[0].getAttribute("component")=="multisearch"){objectId=t[0].getAttribute("id");return $("#"+objectId).select2("val").toString()}break;case"radio":for(var n=0;n<t.length;n++){if(t[n].checked)return t[n].value}break;case"select-one":if(t[0].getAttribute("auxiliar")=="1"){if(t[0].selectedIndex>-1){if(t[0].options[t[0].selectedIndex].value=="0"){return""}else{return t[0].options[t[0].selectedIndex].text}}}else{if(t[0].selectedIndex>-1){if(t[0].options[t[0].selectedIndex].value=="0"){return""}else{return t[0].options[t[0].selectedIndex].value}}}break;case"select-multiple":for(var n=0;n<t[0].options.length;n++){if(t[0].options[n].selected){v+=","+t[0].options[n].value}}v=v.substr(1);if(v){return v};break;case"checkbox":return t[0].checked?"Sim":"Nï¿½o";break}}return""};this.parseTableToJSON=function(){var e=this.mtf.tBodies[0];var t=this.mtf.tHead.rows[0].cells;var n="[";for(var a=0;a<e.rows.length;a++){n+="{";var i=e.rows[a];var r=i.cells.length;if(!document.all)r=i.cells.length-1;var o="";for(var l=0;l<=r;l++){var s=i.cells[l];var d=s.getAttribute("data");if(this.formFieldsAlias[l])colname=this.formFieldsAlias[l];else colname=t[l].innerHTML;if(this.formPostFields[colname]){if(o.length>0)o+=",";o+='"'+escape(colname)+'":"'+escape(d)+'"'}}if(i.getAttribute("dbId")){n+='"id":"'+i.getAttribute("dbId")+'"';if(o.length>0)n+=","+o}else{n+=o}n+="}";if(a<e.rows.length-1)n+=","}n+="]";if(this.inputResult)this.inputResult.value=n;return n};this.selectedRow=null;this.initmultifield(e,t,n)}function tmultifield_start(e,t,n,a,i){if(typeof multifields=="undefined"){multifields=new Object}var r=$("#"+e).attr("name").split("_").slice(1).join("_");multifields[e]=new MultiField(e,a,i);multifields[e].formFieldsAlias=t;multifields[e].formFieldsName=Array();multifields[e].formPostFields=Array();for(key in t){col=t[key];multifields[e].formPostFields[col]=1;multifields[e].formFieldsName.push(r+"_"+col)}multifields[e].formFieldsMandatory=n;multifields[e].mandatoryMessage="The field ^1 is required";multifields[e].storeButton=document.getElementsByName(e+"btnStore")[0];multifields[e].deleteButton=document.getElementsByName(e+"btnDelete")[0];multifields[e].cancelButton=document.getElementsByName(e+"btnCancel")[0];multifields[e].inputResult=document.getElementsByName(r)[0]}function tmultifield_enable_field(e,t){setTimeout(function(){$("form[name="+e+'] div[mtf_name="block_'+t+'"]').remove()},20)}function tmultifield_disable_field(e,t){setTimeout(function(){$("form[name="+e+'] div[mtf_name="block_'+t+'"]').remove()},19);setTimeout(function(){$("form[name="+e+'] div[mtf_name="'+t+'"]').css("position","relative").prepend('<div mtf_name="block_'+t+'" style="position:absolute; width:'+$('div[mtf_name="'+t+'"]').width()+"px; height:"+$('div[mtf_name="'+t+'"]').height()+'px; background: #c0c0c0; opacity:0.5;"></div>')},20)}function tmultifield_clear_field(e,t){$("#"+t+"mfTable .tmultifield_scrolling").html("")}function tmultisearch_start(e,t,n,a,i,r,o,l,s,d){var c={minimumInputLength:t,maximumSelectionLength:n,allowClear:l,placeholder:a,multiple:i,minimumResultsForSearch:s,id:function(e){return e.id+"::"+e.text},templateResult:function(e){if(/<[a-z][\s\S]*>/i.test(e.text)){return $("<span>"+e.text+"</span>")}else{return e.text}},templateSelection:function(e){if(/<[a-z][\s\S]*>/i.test(e.text)){return $("<span>"+e.text+"</span>")}else{return e.text}}};if(i!=="1"){delete c.maximumSelectionLength}$("#"+e).select2(c);if(typeof d!="undefined"){$("#"+e).on("change",function(e){d()})}if(parseInt(n)!==1){$("#"+e).parent().find(".select2-selection").height(o);$("#"+e).parent().find(".select2-selection").find(".select2-selection__rendered").height(o);$("#"+e).parent().find(".select2-selection").find(".select2-selection__rendered").css("overflow-y","auto")}}function tmultisearch_clear_field(e,t){try{$("form[name="+e+'] [name="'+t+'[]"]').val("").trigger("change");$("form[name="+e+'] [name="'+t+'"]').val("").trigger("change")}catch(e){console.log(e)}}function tmultisearch_enable_field(e,t){try{$("form[name="+e+'] [name="'+t+'[]"]').attr("disabled",false);$("form[name="+e+'] [name="'+t+'"]').attr("disabled",false)}catch(e){console.log(e)}}function tmultisearch_disable_field(e,t){try{$("form[name="+e+'] [name="'+t+'[]"]').attr("disabled",true);$("form[name="+e+'] [name="'+t+'"]').attr("disabled",true)}catch(e){console.log(e)}}$.fn.select2.amd.require(["select2/selection/search"],function(e){var t=e.prototype.searchRemoveChoice;e.prototype.searchRemoveChoice=function(){t.apply(this,arguments);this.$search.val("")}});function tmultientry_start(e,t,n,a,i){var r={tags:true,maximumSelectionLength:t,width:n,tokenSeparators:[",",";"]};if(typeof i!="undefined"){$("#"+e).on("change",function(e){i()})}var o=$("#"+e).select2(r)}function tdbuniquesearch_set_value(e,t,n){setTimeout(function(){var e=$("[name="+t+"]");var a=e.data("select2").options.options.hash;var i=e.data("select2").options.options.ajax.url+"&hash="+a+"&value="+n+"&onlyidsearch=1";$.ajax({url:i,dataType:"json"}).done(function(t){if(t.result.length>0){var n=t.result[0];var a=n.split("::");if(!e.find("option[value='"+a[0]+"']").length){e.append(new Option(a[1],a[0],true,true))}var t=[];t.push(a[0]);e.val(t).trigger("change.select2")}}).fail(function(e,t,n){__adianti_error("Error",t+": "+"connection failed")})},1)}function tdbmultisearch_start(e,t,n,a,i,r,o,l,s,d){var c={minimumInputLength:t,maximumSelectionLength:n,allowClear:true,placeholder:a,multiple:i,hash:s,id:function(e){return e.id+"::"+e.text},templateResult:function(e){if(/<[a-z][\s\S]*>/i.test(e.text)){return $("<span>"+e.text+"</span>")}else{return e.text}},templateSelection:function(e){if(/<[a-z][\s\S]*>/i.test(e.text)){return $("<span>"+e.text+"</span>")}else{return e.text}},ajax:{url:r,dataType:"json",quietMillis:100,data:function(e,t){return{value:e.term,hash:s}},processResults:function(e,t){var n=[];$(e.result).each(function(e){var t=this.split("::");n.push({id:t[0],text:t[1]})});return{results:n}}}};if(i!=="1"){delete c.maximumSelectionLength}$("#"+e).select2(c);if(typeof d!="undefined"){$("#"+e).on("change",function(e){d()})}if(parseInt(n)!==1){$("#"+e).parent().find(".select2-selection").height(l);$("#"+e).parent().find(".select2-selection").find(".select2-selection__rendered").height(l);$("#"+e).parent().find(".select2-selection").find(".select2-selection__rendered").css("overflow-y","auto")}}function tradiogroup_enable_field(e,t){setTimeout(function(){$("form[name="+e+"] [name="+t+"]").removeAttr("disabled");$("form[name="+e+"] [name="+t+"]").parent().removeAttr("disabled")},1)}function tradiogroup_disable_field(e,t){setTimeout(function(){$("form[name="+e+"] [name="+t+"]").attr("disabled","");$("form[name="+e+"] [name="+t+"]").parent().attr("disabled","")},1)}function tradiogroup_clear_field(e,t){setTimeout(function(){$("form[name="+e+"] [name="+t+"]").attr("checked",false)},1)}function tseekbutton_enable_field(e,t){try{$("form[name="+e+"] [name="+t+"]").attr("disabled",false);$("form[name="+e+"] [name="+t+"]").removeClass("tfield_disabled").addClass("tseekentry")}catch(e){console.log(e)}setTimeout(function(){$("form[name="+e+"] [for="+t+"]").show()},1)}function tseekbutton_disable_field(e,t){try{$("form[name="+e+"] [name="+t+"]").attr("disabled",true);$("form[name="+e+"] [name="+t+"]").addClass("tfield_disabled").removeClass("tseekentry")}catch(e){console.log(e)}setTimeout(function(){$("form[name="+e+"] [for="+t+"]").hide()},1)}function tselect_enable_field(e,t){try{$("form[name="+e+'] [name="'+t+'[]"]').attr("disabled",false);$("form[name="+e+'] [name="'+t+'[]"]').removeClass("tcombo_disabled").addClass("tcombo")}catch(e){console.log(e)}}function tselect_disable_field(e,t){try{$("form[name="+e+'] [name="'+t+'[]"]').attr("disabled",true);$("form[name="+e+'] [name="'+t+'[]"]').removeClass("tcombo").addClass("tcombo_disabled")}catch(e){console.log(e)}}function tselect_clear_field(e,t){try{$("form[name="+e+'] [name="'+t+'[]"]').val("")}catch(e){console.log(e)}}function tselect_add_option(e,t,n,a){$('<option value="'+n+'">'+a+"</option>").appendTo('form[name="'+e+'"] select[name="'+t+'[]"]')}function tselect_clear(e,t){$('form[name="'+e+'"] select[name="'+t+'[]"]').html("")}function tslider_start(e,t,n,a,i){$(e+"_div").slider({value:t,min:n,max:a,step:i,slide:function(t,n){$(e).val(n.value)}})}function tslider_enable_field(e,t){setTimeout(function(){$("form[name="+e+"] [name="+t+"]").attr("readonly",false)},1);setTimeout(function(){$("form[name="+e+"] [name="+t+"]").next().show()},1)}function tslider_disable_field(e,t){setTimeout(function(){$("form[name="+e+"] [name="+t+"]").attr("readonly",true)},1);setTimeout(function(){$("form[name="+e+"] [name="+t+"]").next().hide()},1)}function tsortlist_start(e,t,n,a){$(e).sortable({connectWith:t,tolerance:"pointer",start:function(e,t){t.item.data("index",t.item.index());t.item.data("parenta",this.id)},receive:function(e,t){if(a>0){if($(this).children().length>a){$(t.sender).sortable("cancel");return}}var n=t.sender;var i=$(this);targetListName=this.getAttribute("itemname");document.getElementById(t.item.attr("id")+"_input").name=targetListName+"[]";if(t.item.css("display")!==i.attr("itemdisplay")){t.item.css("display",i.attr("itemdisplay"));detached=t.item.detach();$(i).append(detached)}},deactivate:n}).disableSelection()}function tsortlist_enable_field(e,t){setTimeout(function(){$("form[name="+e+"] [itemname="+t+"]").sortable("enable")},1)}function tsortlist_disable_field(e,t){setTimeout(function(){$("form[name="+e+"] [itemname="+t+"]").sortable("disable")},1)}function tsortlist_clear_field(e,t){setTimeout(function(){$("form[name="+e+"] [itemname="+t+"]").empty()},1)}function tspinner_start(e,t,n,a,i,r){$(e).spinner({step:i,numberFormat:"n",spin:function(e,t){if(t.value>a){$(this).spinner("value",n);return false}else if(t.value<n){$(this).spinner("value",a);return false}},stop:r});relwidth=$(e).attr("relwidth");if(typeof relwidth!=="undefined"){$(e).width("100%");$(e).parent().width(relwidth)}}function tspinner_enable_field(e,t){setTimeout(function(){$("form[name="+e+"] [name="+t+"]").spinner("enable");$("form[name="+e+"] [name="+t+"]").removeAttr("readonly")},1)}function tspinner_disable_field(e,t){setTimeout(function(){$("form[name="+e+"] [name="+t+"]").spinner("disable");$("form[name="+e+"] [name="+t+"]").removeAttr("disabled");$("form[name="+e+"] [name="+t+"]").attr("readonly",true)},1)}function tfullcalendar_start(e,t,n,a,i,r,o,l,s,d,c,f,u,m){var p=0;var h=0;$("#"+e).fullCalendar({header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},hiddenDays:f,defaultDate:a,defaultView:n,allDaySlot:false,viewRender:function(e,t){setTimeout(function(){__adianti_process_popover()},100)},minTime:d,maxTime:c,slotLabelFormat:"HH:mm",lang:i,editable:t,eventLimit:true,events:r,eventDurationEditable:m,eventStartEditable:u,eventRender:function(e,t){t.find(".fc-title").html(e.title)},dayClick:function(e,t,n){if(o!==""&&p==0&&h==0){__adianti_load_page(o+"&date="+e.format()+"&view="+n.name)}},eventClick:function(e,t,n){if(l!==""&&p==0&&h==0){__adianti_load_page(l+"&id="+e.id+"&key="+e.id+"&view="+n.name)}},eventDragStart:function(e,t,n,a){p=1},eventDragStop:function(e,t,n,a){p=0},eventDrop:function(e,t,n,a){if(s!==""){__adianti_ajax_exec(s+"&id="+e.id+"&key="+e.id+"&start_time="+e.start.format()+"&end_time="+e.end.format())}},eventResizeStart:function(e,t,n,a){h=1},eventResizeStop:function(e,t,n,a){h=0},eventResize:function(e,t,n,a){if(s!==""){__adianti_ajax_exec(s+"&id="+e.id+"&key="+e.id+"&start_time="+e.start.format()+"&end_time="+e.end.format())}},eventAfterAllRender:function(){__adianti_process_popover()}})}
